services:
  backend:
    build:
      context: .
      dockerfile: docker/Dockerfile.backend
    container_name: slurm-usage-backend
    ports:
      - "8100:8100"
    environment:
      - API_KEYS=${API_KEYS}
      - DATA_PATH=/data
      - AUTO_REFRESH_INTERVAL=${AUTO_REFRESH_INTERVAL:-600}
      - CORS_ORIGINS=http://localhost:3100
      - ADMIN_USERS=admin:$$2b$$12$$fG5h7RtwMVKuNJA6f4FICuFzl1AQsucIrgbsAtelSc/b/7GAR1P.K
    volumes:
      - ./data:/data
    restart: unless-stopped

  frontend:
    build:
      context: .
      dockerfile: docker/Dockerfile.frontend
      args:
        - VITE_API_URL=http://localhost:8100
    container_name: slurm-usage-frontend
    ports:
      - "3100:3100"
    depends_on:
      - backend
    restart: unless-stopped

volumes:
  data:
    driver: local
